<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Haley的手记</title>
    <meta name="generator" content="VuePress 1.9.9">
    
    <meta name="description" content="小小菜鸟的进阶之路">
    
    <link rel="preload" href="/interview/assets/css/0.styles.0363c4bc.css" as="style"><link rel="preload" href="/interview/assets/js/app.f057c8d8.js" as="script"><link rel="preload" href="/interview/assets/js/3.3dc38116.js" as="script"><link rel="preload" href="/interview/assets/js/1.9d4b5a9a.js" as="script"><link rel="preload" href="/interview/assets/js/19.cba3ffee.js" as="script"><link rel="prefetch" href="/interview/assets/js/10.1c710285.js"><link rel="prefetch" href="/interview/assets/js/11.f7a883bf.js"><link rel="prefetch" href="/interview/assets/js/12.c488a4c4.js"><link rel="prefetch" href="/interview/assets/js/13.64d3bd15.js"><link rel="prefetch" href="/interview/assets/js/14.285c931b.js"><link rel="prefetch" href="/interview/assets/js/15.a3d2579c.js"><link rel="prefetch" href="/interview/assets/js/16.bcbbb70c.js"><link rel="prefetch" href="/interview/assets/js/17.17c28b03.js"><link rel="prefetch" href="/interview/assets/js/18.fadc22a6.js"><link rel="prefetch" href="/interview/assets/js/4.80cdc7e9.js"><link rel="prefetch" href="/interview/assets/js/5.c4be2016.js"><link rel="prefetch" href="/interview/assets/js/6.31ee3f07.js"><link rel="prefetch" href="/interview/assets/js/7.42825774.js"><link rel="prefetch" href="/interview/assets/js/8.31da17fa.js"><link rel="prefetch" href="/interview/assets/js/9.fe536f01.js">
    <link rel="stylesheet" href="/interview/assets/css/0.styles.0363c4bc.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-7dd95ae2><div data-v-7dd95ae2><div class="password-shadow password-wrapper-out" style="display:none;" data-v-59e6cb88 data-v-7dd95ae2 data-v-7dd95ae2><h3 class="title" data-v-59e6cb88>Haley的手记</h3> <p class="description" data-v-59e6cb88>小小菜鸟的进阶之路</p> <label id="box" class="inputBox" data-v-59e6cb88><input type="password" value="" data-v-59e6cb88> <span data-v-59e6cb88>Konck! Knock!</span> <button data-v-59e6cb88>OK</button></label> <div class="footer" data-v-59e6cb88><span data-v-59e6cb88><i class="iconfont reco-theme" data-v-59e6cb88></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-59e6cb88>vuePress-theme-reco</a></span> <span data-v-59e6cb88><i class="iconfont reco-copyright" data-v-59e6cb88></i> <a data-v-59e6cb88><!---->
          
        <!---->
        2023
      </a></span></div></div> <div class="hide" data-v-7dd95ae2><header class="navbar" data-v-7dd95ae2><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/interview/" class="home-link router-link-active"><!----> <span class="site-name">Haley的手记</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/interview/" class="nav-link"><i class="undefined"></i>
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      学习笔记
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/interview/handbook/foundation/1.html" class="nav-link"><i class="undefined"></i>
  基础篇
</a></li><li class="dropdown-item"><!----> <a href="/interview/handbook/provide/vue.html" class="nav-link"><i class="undefined"></i>
  进阶篇
</a></li><li class="dropdown-item"><!----> <a href="/interview/handbook/apply/vuePress.html" class="nav-link"><i class="undefined"></i>
  应用篇
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      haley 的博客
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://juejin.cn/user/3913917127728232" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  掘金
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/LiangHaley/interview" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-7dd95ae2></div> <aside class="sidebar" data-v-7dd95ae2><div class="personal-info-wrapper" data-v-1fad0c41 data-v-7dd95ae2><!----> <!----> <div class="num" data-v-1fad0c41><div data-v-1fad0c41><h3 data-v-1fad0c41>2</h3> <h6 data-v-1fad0c41>文章</h6></div> <div data-v-1fad0c41><h3 data-v-1fad0c41>0</h3> <h6 data-v-1fad0c41>标签</h6></div></div> <ul class="social-links" data-v-1fad0c41></ul> <hr data-v-1fad0c41></div> <nav class="nav-links"><div class="nav-item"><a href="/interview/" class="nav-link"><i class="undefined"></i>
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      学习笔记
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/interview/handbook/foundation/1.html" class="nav-link"><i class="undefined"></i>
  基础篇
</a></li><li class="dropdown-item"><!----> <a href="/interview/handbook/provide/vue.html" class="nav-link"><i class="undefined"></i>
  进阶篇
</a></li><li class="dropdown-item"><!----> <a href="/interview/handbook/apply/vuePress.html" class="nav-link"><i class="undefined"></i>
  应用篇
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      haley 的博客
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://juejin.cn/user/3913917127728232" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  掘金
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/LiangHaley/interview" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav> <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><a href="/interview/" class="sidebar-heading clickable router-link-active"><span>欢迎学习</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/interview/" aria-current="page" class="sidebar-link">haley博客简介</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/interview/handbook/foundation/1" class="sidebar-heading clickable"><span>基础篇</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/interview/handbook/provide/vue" class="sidebar-heading clickable open"><span>进阶篇</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/interview/handbook/provide/vue.html" class="sidebar-link">vue学习</a></li><li><a href="/interview/handbook/provide/vue3.html" aria-current="page" class="active sidebar-link">vue3学习</a></li><li><a href="/interview/handbook/provide/TypeScript.html" class="sidebar-link">TypeScript</a></li><li><a href="/interview/handbook/provide/2.html" class="sidebar-link">第二篇</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/interview/handbook/apply/vuePress" class="sidebar-heading clickable"><span>应用篇</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/interview/handbook/components/loading" class="sidebar-heading clickable"><span>插件&amp;&amp;组件</span> <span class="arrow right"></span></a> <!----></section></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-59e6cb88 data-v-7dd95ae2><h3 class="title" data-v-59e6cb88></h3> <!----> <label id="box" class="inputBox" data-v-59e6cb88><input type="password" value="" data-v-59e6cb88> <span data-v-59e6cb88>Konck! Knock!</span> <button data-v-59e6cb88>OK</button></label> <div class="footer" data-v-59e6cb88><span data-v-59e6cb88><i class="iconfont reco-theme" data-v-59e6cb88></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-59e6cb88>vuePress-theme-reco</a></span> <span data-v-59e6cb88><i class="iconfont reco-copyright" data-v-59e6cb88></i> <a data-v-59e6cb88><!---->
          
        <!---->
        2023
      </a></span></div></div> <div data-v-7dd95ae2><div data-v-7dd95ae2><main class="page" style="padding-right:0;"><section style="display:;"><div class="page-title"><h1 class="title"></h1> <div data-v-8a445198><!----> <!----> <!----> <!----></div></div> <div class="theme-reco-content content__default"><p>这一章节主要学习Vue3相关内容</p> <h3 id="composition-选项式api"><a href="#composition-选项式api" class="header-anchor">#</a> Composition 选项式api</h3> <p>写法:script 添加 stepup 指定选项式api
内置 defineProps({}) 接收父组件传入的参数</p> <h3 id="ref-和-reactive-区别"><a href="#ref-和-reactive-区别" class="header-anchor">#</a> ref 和 reactive 区别？</h3> <p>ref 声明响应式数据 ref.value自动解包  赋值为字符串 数字简单数据类型
reactive 监听对象</p> <div class="language- extra-class"><pre class="language-text"><code>export const toReactive =&lt;T extends unknown&gt;(value:T):T =&gt; isObject(value):reactive(value):value
ref(obj) === reactive({value:obj})
</code></pre></div><h3 id="ref-和-shallowref-的区别-以及-reactive-和-shallowreactive-的区别"><a href="#ref-和-shallowref-的区别-以及-reactive-和-shallowreactive-的区别" class="header-anchor">#</a> ref 和 shallowRef 的区别，以及 reactive 和 shallowReactive 的区别？</h3> <p>shallowRef 只监听第一层 即.value,不过我们可以使用triggerRef(xxx),在深层内容变更后，手动触发更新，需要注意的是shallowReactive 没有对应的方法</p> <h3 id="watcheffect-与-watch-的区别"><a href="#watcheffect-与-watch-的区别" class="header-anchor">#</a> watchEffect 与 watch 的区别</h3> <div class="language- extra-class"><pre class="language-text"><code>watch 和 watchEffect 都能监听响应式数据的变化，
不同的是 watch 会明确监听某一个响应式数据的变化，而watchEffect则是隐士的监听回调函数中的响应式数据
watch 在响应数据初始化是不会执行回调函数的，watchEffect在响应式数据初始化时就会立即执行回调函数
flush: 'post' 响应式更新watch 或 watchEffect 下dom 元素的值
watchEffect、watchPostEffect、watchSyncEffect 后两者是前者的语法糖，就是将第二个参数中的 flush，指定为对应值，分别为：flush?: 'pre' | 'post' | 'sync' // 默认：'pre'
</code></pre></div><p>defineAsyncComponent 异步引入 打包时单独被打包
安装 rollup-plugin-visualizer 进行打包产物分析</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;script setup&gt;
import { defineAsyncComponent } from 'vue'

const AdminPage = defineAsyncComponent(() =&gt;
  import('./components/AdminPageComponent.vue')
)
&lt;/script&gt;

&lt;template&gt;
  &lt;AdminPage /&gt;
&lt;/template&gt;
</code></pre></div><h3 id="ref-源码解析"><a href="#ref-源码解析" class="header-anchor">#</a> ref 源码解析</h3> <p>Object.prototype.toString.call(c).slice(8, -1);  判断数据类型</p> <div class="language- extra-class"><pre class="language-text"><code>********createReactiveObject*********************
import {ref} from 'vue'
const num = ref(0)//定义基本的数据类型
//调用vue 中ref 文件 
function ref(value) {
    return createRef(value, false);
}
// 通过isRef函数来判断所定义的值是否已经是一个ref对象，如果是就直接返回该值。否则实例化RefImpl类，给该值赋予各个关于ref的属性，将其转化为一个ref对象
function createRef(rawValue, shallow) {
    if (isRef(rawValue)) { 
        return rawValue;
    }
    return new RefImpl(rawValue, shallow);
}

function isRef(r) {
/*判断该值的__v_isRef属性是否为true,因为前面r=0,并没有所谓__v_isRef属性，所以这里r.__v_isRef是为undefined。这里的返回值是为false
*/
    return !!(r &amp;&amp; r.__v_isRef === true);
}
//RefImpl的构造器接收两个值，一个value所定义的原始值，一个__v_isShallow是否为浅层响应式
class RefImpl {
    constructor(value, __v_isShallow) {
    //是否为浅层响应式
        this.__v_isShallow = __v_isShallow; //传false
    //dep 是一个 Set 类型的数据，它的作用是用来存储当前的 ref 值收集的依赖
        this.dep = undefined;
    //前面说到这个属性用来判断是否转化为ref对象
        this.__v_isRef = true;
    //用于保存当前 ref 值对应的原始值，当传递的参数是基本数据类型时，_value 和 _rawValue 相同。如果传递的参数是一个对象的话，_rawValue 用于保存转化前的原始值。
        this._rawValue = __v_isShallow ? value : toRaw(value);
    //用于保存 ref 当前的值，如果传递的参数是基本数据类型的话，_value 和 _rawValue 相同。如果传递的参数是一个对象的话，_value 就是经过 reactive 函数转化过的值。
        this._value = __v_isShallow ? value : toReactive(value);
    }
    //当我们使用 .value 读取属性的时候，会执行 get value(){} 函数，并将函数的返回值作为 .value 读取到的值
    get value() {
        trackRefValue(this);
        return this._value;
    }
    //在 set value() {} 函数中，判断新值和旧值有没有发生改变，如果有变化的是，则重新赋值 _rawValue 和 _value 属性，并触发当前 ref 值的依赖重新执行。
    set value(newVal) {
    //判断原始值是否为浅层响应式或是否为readonly对象
        const useDirectValue = this.__v_isShallow || isShallow(newVal) || isReadonly(newVal);
    //如果该值不是响应式或readonly对象，则返回原来的值，否则将该值通过toRaw转化为原来的target对象
        newVal = useDirectValue ? newVal : toRaw(newVal);
        //检测两个值是否相等，如果不同了就赋值为新的
        if (hasChanged(newVal, this._rawValue)) {
            this._rawValue = newVal;
        //原始值如果为响应式则直接返回，否则将其转化为响应式
            this._value = useDirectValue ? newVal : toReactive(newVal);
        //触发依赖，更新视图
            triggerRefValue(this, newVal);
        }
    }
}
关于get value(){}的有关函数
function trackRefValue(ref) {
    // 判断是否需要收集依赖
    // shouldTrack 全局变量，代表当前是否需要 track 收集依赖
    // activeEffect 全局变量，代表当前的副作用对象 ReactiveEffect
    if (shouldTrack &amp;&amp; activeEffect) {
        ref = toRaw(ref);
    // 如果没有 dep 属性，则初始化 dep，dep 是一个 Set&lt;ReactiveEffect&gt;，存储副作用函数
    // trackEffects 收集依赖
        if ((process.env.NODE_ENV !== 'production')) {
            trackEffects(ref.dep || (ref.dep = createDep()), {
                target: ref,
                type: &quot;get&quot; /* TrackOpTypes.GET */,
                key: 'value'
            });
        } else {
            trackEffects(ref.dep || (ref.dep = createDep()));
        }
    }
}
function isShallow(value) {
    return !!(value &amp;&amp; value[&quot;__v_isShallow&quot; /* ReactiveFlags.IS_SHALLOW */]);//判断原始值是否为浅层响应式
}
function isReadonly(value) {
    return !!(value &amp;&amp; value[&quot;__v_isReadonly&quot; /* ReactiveFlags.IS_READONLY */]);//判断原始值是否为只读
}

function reactive(target) {
    //如果该对象是只读的，就直接返回
    // if trying to observe a readonly proxy, return the readonly version.
    if (isReadonly(target)) {
        return target;
    }
    return createReactiveObject(target, false, mutableHandlers, mutableCollectionHandlers, reactiveMap);
}

/*createReactiveObject接收五个参数：
target被代理的对象，
isReadonl是不是只读的，
baseHandlers proxy的捕获器，
collectionHandlers针对集合的proxy捕获器，
proxyMap一个用于缓存proxy的`WeakMap`对象*/
function createReactiveObject(target, isReadonly, baseHandlers, collectionHandlers, proxyMap) {
//如果target不是对象则提示并返回
    if (!isObject(target)) {
        if ((process.env.NODE_ENV !== 'production')) {
            console.warn(`value cannot be made reactive: ${String(target)}`);
        }
        return target;
    }
    // 如果target已经是proxy是代理对象则直接返回.
    if (target[&quot;__v_raw&quot; /* ReactiveFlags.RAW */] &amp;&amp;
        !(isReadonly &amp;&amp; target[&quot;__v_isReactive&quot; /* ReactiveFlags.IS_REACTIVE */])) {
        return target;
    }
    // 从proxyMap中获取缓存的proxy对象，如果存在的话，直接返回proxyMap中对应的proxy。否则创建proxy。
    const existingProxy = proxyMap.get(target);
    if (existingProxy) {
        return existingProxy;
    }
    // 并不是任何对象都可以被proxy所代理。这里会通过getTargetType方法来进行判断。
    const targetType = getTargetType(target);
    //当类型值判断出是不能代理的类型则直接返回
    if (targetType === 0 /* TargetType.INVALID */) {
        return target;
    }
    //进行target代理操作
    const proxy = new Proxy(target, targetType === 2 /* TargetType.COLLECTION */ ? collectionHandlers : baseHandlers);
    proxyMap.set(target, proxy);
    return proxy;
}

//1.进入判断如果value有__v_skip属性且为true或对象是可拓展则返回0，否则走类型判断函数
function getTargetType(value) {
//Object.isExtensible() 方法判断一个对象是否是可扩展的（是否可以在它上面添加新的属性）。
    return value[&quot;__v_skip&quot; /* ReactiveFlags.SKIP */] || !Object.isExtensible(value)
        ? 0 /* TargetType.INVALID */
        : targetTypeMap(toRawType(value));
}
//2.这里通过Object.prototype.toString.call(obj)来判断数据类型
const toRawType = (value) =&gt; {
    // extract &quot;RawType&quot; from strings like &quot;[object RawType]&quot;
    return toTypeString(value).slice(8, -1);
};
const toTypeString = (value) =&gt; objectToString.call(value);
//3.这里rawType是为'Object'所以会返回1
function targetTypeMap(rawType) {
    switch (rawType) {
        case 'Object':
        case 'Array':
            return 1 /* TargetType.COMMON */;
        case 'Map':
        case 'Set':
        case 'WeakMap':
        case 'WeakSet':
            return 2 /* TargetType.COLLECTION */;
        default:
            return 0 /* TargetType.INVALID */;//返回0说明除前面的类型外其他都不能被代理，如Date，RegExp，Promise等
    }
}
</code></pre></div><h3 id="基本指令v-focus"><a href="#基本指令v-focus" class="header-anchor">#</a> 基本指令v-focus</h3> <div class="language- extra-class"><pre class="language-text"><code>input组件初始化渲染时聚焦 
&lt;script setup&gt;
// 在模板中启用 v-focus
const vFocus = {
  mounted: (el) =&gt; el.focus()
}
&lt;/script&gt;

&lt;template&gt;
  &lt;input v-focus /&gt;
&lt;/template&gt;

指令钩子
const myDirective = {
  // 在绑定元素的 attribute 前
  // 或事件监听器应用前调用
  created(el, binding, vnode, prevVnode) {
    // 下面会介绍各个参数的细节
  },
  // 在元素被插入到 DOM 前调用
  beforeMount(el, binding, vnode, prevVnode) {},
  // 在绑定元素的父组件
  // 及他自己的所有子节点都挂载完成后调用
  mounted(el, binding, vnode, prevVnode) {},
  // 绑定元素的父组件更新前调用
  beforeUpdate(el, binding, vnode, prevVnode) {},
  // 在绑定元素的父组件
  // 及他自己的所有子节点都更新后调用
  updated(el, binding, vnode, prevVnode) {},
  // 绑定元素的父组件卸载前调用
  beforeUnmount(el, binding, vnode, prevVnode) {},
  // 绑定元素的父组件卸载后调用
  unmounted(el, binding, vnode, prevVnode) {}
}
</code></pre></div><h3 id="封装一个节流指令"><a href="#封装一个节流指令" class="header-anchor">#</a> 封装一个节流指令</h3> <div class="language- extra-class"><pre class="language-text"><code>/*
  需求：防止按钮在短时间内被多次点击，使用节流函数限制规定时间内只能点击一次。

  思路：
    1、第一次点击，立即调用方法并禁用按钮，等延迟结束再次激活按钮
    2、将需要触发的方法绑定在指令上
  
  使用：给 Dom 加上 v-throttle 及回调函数即可
  &lt;button v-throttle=&quot;debounceClick&quot;&gt;节流提交&lt;/button&gt;
  因为用了el.disabled也就是dom元素的disabled的属性，没disabled属性得使用，是不生效得
*/
import type { Directive, DirectiveBinding } from &quot;vue&quot;;
interface ElType extends HTMLElement {
	__handleClick__: () =&gt; any;
	disabled: boolean;
}
const throttle: Directive = {
	mounted(el: ElType, binding: DirectiveBinding) {
		if (typeof binding.value !== &quot;function&quot;) {
			throw &quot;callback must be a function&quot;;
		}
		let timer: NodeJS.Timeout | null = null;
		el.__handleClick__ = function () {
			if (timer) {
				clearTimeout(timer);
			}
			if (!el.disabled) {
				el.disabled = true;
				binding.value();
				timer = setTimeout(() =&gt; {
					el.disabled = false;
				}, 1000);
			}
		};
		el.addEventListener(&quot;click&quot;, el.__handleClick__);
	},
	beforeUnmount(el: ElType) {
		el.removeEventListener(&quot;click&quot;, el.__handleClick__);
	}
};
export default throttle;
</code></pre></div><h3 id="自定义hooks"><a href="#自定义hooks" class="header-anchor">#</a> 自定义hooks</h3> <div class="language- extra-class"><pre class="language-text"><code>import {ref,watch} from 'vue';
export function useSub({num1,num2}){
    const subNum = ref(0);
    watch([num1,num2],([num1,num2]) =&gt;{
        subFn(num1,num2)
    })
    const subFn = (num1,num2) =&gt;{
        subNum.value = num1 - num2
    }
    return {
        subNum,
        subFn
    }
}
</code></pre></div><h3 id="vue-ssr-实现过程"><a href="#vue-ssr-实现过程" class="header-anchor">#</a> vue SSR 实现过程</h3> <div class="language- extra-class"><pre class="language-text"><code>创建工程 vue cli 3.0
vue create ssr
安装依赖
渲染器 vue-server-renderer
nodejs 服务器 express
根目录下创建 server 文件夹 index.js文件
index.js index.js 中写Node 写页面内容

</code></pre></div><h3 id="ssr由来"><a href="#ssr由来" class="header-anchor">#</a> SSR由来</h3> <p>web1.0 服务端渲染 后端返回渲染后的页面给浏览器 --- nodejs时期 客户端渲染(客户端 url -- web server -- 返回html js 脚本 -- 浏览器执行js 脚本 -- java服务器 --- 查询mysql---返回浏览器数据 --浏览器渲染) --- SSR 服务端渲染(客户端url -- web server node服务器 --根据客户请求的url 执行对应页面并且向后端请求数据，并且根据返回的数据组装html --返回给客户端 --- 渲染页面 --- 向前端服务器请求javascript 脚本 --- 浏览器执行返回脚本---执行javascript 脚本 绑定动态事件 --- 调用后台接口 并且查询数据 返回数据 动态渲染页面---绑定事件--- )</p> <h2 id="vue-router"><a href="#vue-router" class="header-anchor">#</a> vue-router</h2> <h3 id="params-和-query-的区别"><a href="#params-和-query-的区别" class="header-anchor">#</a> params 和 query 的区别</h3> <div class="language- extra-class"><pre class="language-text"><code>1. query 可以使用name 或者path 方式跳转
//query传参，使用name跳转
this.$router.push({
    name:'second',
    query: {
        queryId:'20180822',
        queryName: 'query'
    }
})

//query传参，使用path跳转
this.$router.push({
    path:'second',
    query: {
        queryId:'20180822',
        queryName: 'query'
    }
})

//query传参接收
this.queryName = this.$route.query.queryName;
this.queryId = this.$route.query.queryId;

params只能使用name方式进行跳转引入
//params传参 使用name
this.$router.push({
  name:'second',
  params: {
    id:'20180822',
     name: 'query'
  }
})

//params接收参数
this.id = this.$route.params.id ;
this.name = this.$route.params.name ;

2. 浏览器url 显示不同
params localhost:8080/second/1245314/wendy 页面刷新数据不丢失
query  localhost:8080?queryId='20180822'&amp;queryName='query'  
</code></pre></div><h3 id="手写vue-router"><a href="#手写vue-router" class="header-anchor">#</a> 手写vue-router</h3> <div class="language- extra-class"><pre class="language-text"><code>/****** myVueRouter ******/
let vue = null;
class HistoryRoute {
    constructor(){
        this.current = null;
    }
}
class VueRouter{
    constructor(options){
        this.mode = options.mode || 'hash';
        this.routes = options.routes || [];
        this.routesMap = this.createMap(this.routes);
        this.history = new HistoryRoute();
        this.init()
    }
    init(){
        if(this.mode == 'hash'){
            location.hash ? '':(location.hash = '/');
            window.addEventListener('load', () =&gt; {
                // /home location.hash
				this.history.current = location.hash.slice(1); 
			});
			window.addEventListener('hashchange', () =&gt; {
                 // /home location.hash
				this.history.current = location.hash.slice(1);
			});
        }else{
            location.pathname ? '' : (location.pathname = '/');
            window.addEventListener('load',()=&gt;{
                this.history.current = location.pathname;
                
            })
            window.addEventListener('popstate',()=&gt;{
                this.history.current = location.pathname;
            })
        } 
    }
    //传入routes 返回 /home:{compoent:home,name:home}的对象
    createMap(routes){
        return routes.reduce((pre,current)=&gt;{
            pre[current.path] = current.component;
            return pre;
        },{})
    }
}
//组件全局注册在vue上
VueRouter.install = function(v){
    vue = v;
    vue.mixin({
        beforeCreate(){
            if(this.$options &amp;&amp; this.$options.router){
                如果是根组件
                this._root = this;
                this._router = this.$options.router;
                Vue.util.defineRective(thid.'xxx',this._router.history);
            }else{
                this._root = this.$parent &amp;&amp; this.$parent._root;
            }
            Object.defineProperty(this , '$router' ,{
                get(){
                    return this._root._router;
                }
            })
            Object.defineProperty(this , '$route' ,{
                get(){
                    return this._root._router.history.current;
                }
            })

        }
    });
    vue.component('router-link',{
        props:{
            to:string,
        },
        render(h){
            let mode = this._self._root._router.mode
            let to = mode === 'hash' ? '#' + this.to : this.to;
            return h('a',{attrs:{herf:to}}, this.$slots.default);
        }
    })
    //组件全局注册在vue上
    vue.component('router-view',{
        render(h){
            let current = this._self._root._router.history.current;
            let routeMap = this._self._root._router.routesMap;
            return h(routeMap(current))
        }
    })
}

/**************index.js******************/
import VueRouter from './myVueRouter';
Vue.use(VueRouter)
const routes=[
    {
        path:'/home',
        name:'Home',
        component:Home
    },
    {
        path:'/about',
        name:'About',
        component:About
    }
]
const router = new VueRouter({
    mode:'hash',
    routes
})
export default router;
</code></pre></div><p>声明vue-router 中 meta 中的数据类型</p> <div class="language- extra-class"><pre class="language-text"><code>declare module 'vue-router'{
    interface RouteMeta{
        title:string;
    }
}
router.js
meta:{
    title:&quot;登录页面&quot;
}
main.js
router.beforeEach((to, from, next) =&gt; {
    document.title = to.meta.title; 
})
</code></pre></div><p>vue-router 过渡动画:子组件必须包含到一个root</p> <div class="language- extra-class"><pre class="language-text"><code>import 'animate.css';
&lt;template&gt;
  &lt;router-view #default=&quot;{Component}&quot;&gt;
    &lt;transition  :enter-active-class=&quot;`animate__animated animate__bounceIn`&quot;&gt;
        &lt;component :is=&quot;Component&quot;&gt;&lt;/component&gt;
    &lt;/transition&gt;
 &lt;/router-view&gt;
&lt;/template&gt;
</code></pre></div></div></section> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev"><a href="/interview/handbook/provide/vue.html" class="prev">
          vue学习
        </a></span> <span class="next"><a href="/interview/handbook/provide/TypeScript.html">
          TypeScript
        </a></span></p></div> <div class="comments-wrapper"><!----></div></main></div> <!----></div> <ul class="sub-sidebar sub-sidebar-wrapper" style="width:0;" data-v-b57cc07c data-v-7dd95ae2></ul></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div></div></div>
    <script src="/interview/assets/js/app.f057c8d8.js" defer></script><script src="/interview/assets/js/3.3dc38116.js" defer></script><script src="/interview/assets/js/1.9d4b5a9a.js" defer></script><script src="/interview/assets/js/19.cba3ffee.js" defer></script>
  </body>
</html>
